\chapter{Аналитическая часть}

В данном разделе будут разобраны алгоритмы нахождения расстояний Левенштейна и Дамерау-Левенштейна.

\section{Расстояние Левенштейна}

Расстояние Левенштейна (р. Л.) между двумя строками --- метрика, позволяющая определить «схожесть» двух строк --- минимальное количество операций вставки одного символа, удаления одного символа и замены одного символа на другой, необходимых для превращения одной строки в другую (каждая операция имеет свою цену --- штраф). 

Редакционное предписание --- последовательность действий, необходимых для получения из первой строки вторую, и минимизирующую суммарную цену (и является расстоянием Левенштейна).
Пусть $S_{1}$ и $S_{2}$ --- две строки, длиной $N$ и $M$ соответственно. 
Введены следующие обозначения:
\begin{itemize}
	\item I (aнгл. Insert) --- вставка символа в произвольной позиции ($w(\lambda,b)=1$);
	\item D (aнгл. Delete) --- удаление символа в произвольной позиции ($w(\lambda,b)=1$);
	\item R (aнгл. Replace) --- замена символа на другой ($w(a,b)=1, \medspace a \neq b$);
	\item M (aнгл. Match) --- совпадение двух символов ($w(a,a)=0$).
\end{itemize}
С учетом введенных обозначений, расстояние Левенштейна может быть подсчитано по формуле
\begin{equation}
	\label{eq:D}
	D(i, j) = \begin{cases}
		0 &\text{i = 0, j = 0}\\
		i &\text{j = 0, i > 0}\\
		j &\text{i = 0, j > 0}\\
		\min \lbrace \\
		\qquad D(i, j-1) + 1\\
		\qquad D(i-1, j) + 1 &\text{i > 0, j > 0}\\
		\qquad D(i-1, j-1) + m(a[i], b[j]) \\
		\rbrace
	\end{cases},
\end{equation}
где функция $m(a, b)$ определена как:
\begin{equation}
	\label{eq:m}
	m(a, b) = \begin{cases}
		0 &\text{если a = b,}\\
		1 &\text{иначе}
	\end{cases}.
\end{equation}

\subsection{Матричный алгоритм нахождения расстояния}

Рекурсивный алгоритм вычисления расстояния Левенштейна может быть не эффективен при больших $i$ и $j$, так как множество промежуточных значений $D(i, j)$ вычисляются не один раз, что сильно замедляет время выполнения программы.

В качестве структуры данных для хранения промежуточных значений можно использовать \textit{матрицу}, имеющую  размеры:

\begin{equation}
	(length(S1)+ 1) \times ((length(S2) + 1),
\end{equation}
где $length(S)$ --- длина строки $S$

Значение в ячейке $[i, j]$ равно значению $D(S1[1...i], S2[1...j])$. Первая строка и первый столбец заполнены нулями.

Всю таблицу (за исключением первого столбца и первой строки) заполняем в соответствии с формулой
\begin{equation}
	\label{eq:mat1}
	A[i][j] = min \begin{cases}
		A[i-1][j] + 1\\
		A[i][j-1] + 1\\
		A[i-1][j-1] + m(S1[i], S2[j]))\\
	\end{cases},
\end{equation}
где функция $m(S1[i], S2[j])$ определена как:
\begin{equation}
	\label{eq:m2}
	m(S1[i], S2[j]) = \begin{cases}
		0, &\text{если $S1[i - 1] = S2[j - 1]$,}\\
		1, &\text{иначе}
	\end{cases}.
\end{equation}
Результат вычисления расстояния Левенштейна будет ячейка матрицы с индексами $i = length(S1$) и $j = length(S2)$.

\section{Расстояние Дамерау-Левенштейна}

Расстояние Дамерау-Левенштейна (р. Д-Л.) между двумя строками, состоящими из конечного числа символов --— это минимальное число операций вставки, удаления, замены одного символа и транспозиции двух соседних символов, необходимых для перевода одной строки в другую.

Является модификацией расстояния Левенштейна --- добавлена операции транспозиции, то есть перестановки, двух символов.

Расстояние Дамерау-Левенштейна может быть найдено по формуле
\begin{equation}
	\label{eq:d}
	d_{a,b}(i, j) = \begin{cases}
		\max(i, j), &\text{если }\min(i, j) = 0,\\
		\min \lbrace \\
		\qquad d_{a,b}(i, j-1) + 1,\\
		\qquad d_{a,b}(i-1, j) + 1,\\
		\qquad d_{a,b}(i-1, j-1) + m(a[i], b[j]), &\text{иначе}\\
		\qquad \left[ \begin{array}{cc}d_{a,b}(i-2, j-2) + 1, &\text{если }i,j > 1;\\
			\qquad &\text{}a[i] = b[j-1]; \\
			\qquad &\text{}b[j] = a[i-1]\\
			\qquad \infty, & \text{иначе}\end{array}\right.\\
		\rbrace
	\end{cases},
\end{equation}

Формула выводится по тем же соображениям, что и формула (\ref{eq:D}).

\subsection{Рекурсивный алгоритм нахождения расстояния}
Рекурсивный алгоритм вычисления расстояния Дамерау-Левенштейна реализует формулу \ref{eq:d}

Минимальная цена преобразования --- минимальное значение приведенных вариантов.

Если полагать, что \textit{a', b'} --- строки $a$ и $b$ без последнего символа соответственно, а \textit{a'', b''} --- строки $a$ и $b$ без двух последних символов, то цена преобразования из строки $a$ в $b$ выражается из элементов, представленных ниже:
\begin{enumerate}
	\item[1)] сумма цены преобразования строки $a'$ в $b$ и цены проведения операции удаления, которая необходима для преобразования $a'$ в $a$;
	\item[2)] сумма цены преобразования строки $a$ в $b'$  и цены проведения операции вставки, которая необходима для преобразования $b'$ в $b$;	
	\newpage
	\item[3)] сумма цены преобразования из $a'$ в $b'$ и операции замены, предполагая, что $a$ и $b$ оканчиваются на разные символы;
	\item[4)] сумма цены преобразования из $a''$ в $b''$ и операции перестановки, предполагая, что длины $a''$ и $b''$ больше 1 и последние два символа $a''$, поменянные местами, совпадут с двумя последними символами $b''$;
	\item[5)] цена преобразования из $a'$ в $b'$, предполагая, что $a$ и $b$ оканчиваются на один и тот же символ.
\end{enumerate}

\subsection{Матричный алгоритм нахождения расстояния}

Рекурсивный алгоритм вычисления расстояния Дамерау-Левенштейна может быть не эффективен при больших $i$ и $j$, так как множество промежуточных значений $D(i, j)$ вычисляются не один раз, что сильно замедляет время выполнения программы.

В качестве структуры данных для хранения промежуточных значений можно использовать матрицу, имеющую размеры:
\begin{equation}
	(length(S1)+ 1)\\\times((length(S2) + 1),
\end{equation}
где $length(S)$ --- длина строки $S$

Значение в ячейке $[i, j]$ равно значению $D(S1[1...i], S2[1...j])$. Первая строка и первый столбец тривиальны.

Всю таблицу (за исключением первого столбца и первой строки) заполняем в соответствии с формулой
\begin{equation}
	\label{eq:mat}
	A[i][j] = min \begin{cases}
		A[i-1][j] + 1\\
		A[i][j-1] + 1\\
		A[i-1][j-1] + m(S1[i], S2[j]))\\
		A[i-2][j-2] + 1, \text{если $i > 1$, $j > 1$ и} \\
		\text{\quad \quad $S1[i - 2] = S2[j - 1]$, $S2[i - 1] = S2[j - 2]$}
	\end{cases},
\end{equation}
где функция $m(S1[i], S2[j])$ определена как:
\begin{equation}
	\label{eq:m2}
	m(S1[i], S2[j]) = \begin{cases}
		0, &\text{если $S1[i - 1] = S2[j - 1]$,}\\
		1, &\text{иначе}
	\end{cases}
\end{equation}

Результат вычисления расстояния Дамерау-Левенштейна будет ячейка матрицы с индексами $i = length(S1$) и $j = length(S2)$.


\subsection{Рекурсивный алгоритм нахождения расстояния с использованием кеша}

Чтобы уменьшить время работы рекурсивного алгоритма заполнения можно использовать кеш, который будет представлять собой матрицу.

Ускорение достигается за счет использования матрицы для предотвращения повторной обработки уже обработанных данных.

Если данные ещё не были обработаны, то результат работы рекурсивного алгоритма заносится в матрицу. 
В случае, если обработанные данные встречаются снова, то для них расстояние не находится и выполняется следующий шаг.


\section{Вывод}
В данном разделе были рассмотрены алгоритмы поиска расстояния Левенштейна и расстояния Дамерау-Левенштейна. В частности были приведены рекурентные формулы работы алгоритмов, объяснена разница между расстоянием Левенштейна и расстоянием Дамерау-Левенштейна.
